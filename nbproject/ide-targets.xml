<?xml version="1.0" encoding="UTF-8"?>
<!-- Created by Brian Burch on August 25, 2005
     Netbeans debug targets are now held in this file.
    -->
<project basedir=".." name="SIP Communicator-IDE">
    <import file="../build.xml"/>
    <target depends="deploy-os-specific-bundles" description="Starts felix and runs sip-comunicator gui (use latest build)." name="debug-nb-wholeApp">
        <nbjpdastart addressproperty="jpda.address" name="SIP Communicator" transport="dt_socket">
            <classpath refid="debug.class.path"/>
            <sourcepath refid="project.source.path"/>
        </nbjpdastart>
        <!-- we allow users to pass command line args using the "args" system
             property. However we need to manually set that prop to an empty
             string here (in the normal case the user will not have defined
             any - otherwise the application would find an argument with
             the value ${args} )-->
        <property name="args" value="--multiple"/>
        <!-- fork=true no longer prevents debug break points latching... -->
        <java classname="net.java.sip.communicator.launcher.SIPCommunicator" failonerror="true" fork="true">
            <classpath refid="debug.class.path"/>
            <jvmarg value="-Xdebug"/>
            <jvmarg value="-Xnoagent"/>
            <jvmarg value="-Djava.compiler=none"/>
            <jvmarg value="-Xrunjdwp:transport=dt_socket,address=${jpda.address}"/>
            <!-- Sets the charset for the messages -->
            <!--sysproperty key="icq.custom.message.charset" value="windows-1252"/-->
            <!-- Tell felix to run sip-communicator-->
            <sysproperty key="felix.config.properties" value="file:${lib}/felix.client.run.properties"/>
            <!-- Tell java.util.logging about our logging preferences -->
            <sysproperty key="java.util.logging.config.file" value="${lib}/logging.properties"/>
            <sysproperty key="java.net.preferIPv6Addresses" value="false"/>
            <!--sysproperty key="net.java.sip.communicator.SC_HOME_DIR_LOCATION"
                    value="${user.home}/schome"/-->
            <!-- Setting properties necessary for dependencies on native libs.-->
            <sysproperty key="java.library.path" path="${ld.library.path}:${path}:${dyld.library.path}"/>
            <!-- pass l10n properties from ant call for
                 easy translation debugging -->
            <sysproperty key="user.language" value="${user.language}"/>
            <sysproperty key="user.country" value="${user.country}"/>
            <sysproperty key="user.variant" value="${user.variant}"/>
            <env key="LD_LIBRARY_PATH" path="${ld.library.path}"/>
            <env key="PATH" path="${path}"/>
            <env key="DYLD_LIBRARY_PATH" path="${dyld.library.path}"/>
            <!-- make sure that we automatically enable system.out when running
                 SIP Communicator from Ant-->
            <arg line="--debug"/>
            <!-- pass to SC args that have been specified by the user -->
            <arg line="${args}"/>
        </java>
    </target>
    <!-- TODO: edit the following target according to your needs -->
    <!-- (more info: http://www.netbeans.org/kb/articles/freeform-config.html#debugj2se) -->
    <target depends="deploy-os-specific-bundles,load-properties" description="Starts felix and runs sip-comunicator gui (use latest build)." name="debug-nb">
        <!-- we allow users to pass command line args using the "args" system
             property. However we need to manually set tha prop to an empty
             string here or otherwise the application would get an argument with
             the value ${args}-->
        <property name="args" value=""/>
        <condition else="" property="jvmarg.line" value="-Xdock:name='${application.name}' -Xdock:icon='resources/images/logo/sc_logo_128x128.icns'">
            <isset property="is.running.macos"/>
        </condition>
        <condition else="" property="jvmarg.splash" value="-splash:resources/install/resources/splash.gif">
            <isset property="splashscreen.enable"/>
        </condition>
        <!-- Jitsi on Mac OS X uses a JVMTI agent to handle kAEGetURL
             AppleScript events. To enable it use jvmarg.aegeturl property -->
        <condition else="" property="jvmarg.aegeturl" value="-agentlib:AEGetURLEventHandlerAgent">
            <isset property="aegeturl.enable"/>
        </condition>
        <condition else="" property="jvm.maxheapsize" value="-Xmx256m">
            <os arch="i386"/>
        </condition>
        <!-- forking prevents from debugging -->
        <nbjpdastart addressproperty="jpda.address" name="jitsi" transport="dt_socket"/>
        <java classname="net.java.sip.communicator.launcher.SIPCommunicator" classpathref="project.class.path" failonerror="true" fork="true">
            <!-- Sets the charset for the messages -->
            <!--sysproperty key="icq.custom.message.charset" value="windows-1252"/-->
            <!-- Tell felix to run Jitsi -->
            <sysproperty key="felix.config.properties" value="file:${lib}/felix.client.run.properties"/>
            <!-- Tell java.util.logging about our logging preferences -->
            <sysproperty key="java.util.logging.config.file" value="${lib}/logging.properties"/>
            <sysproperty key="java.net.preferIPv6Addresses" value="${java.net.preferIPv6Addresses}"/>
            <!--sysproperty key="net.java.sip.communicator.SC_HOME_DIR_LOCATION"
                value="${user.home}"/>
            <sysproperty key="net.java.sip.communicator.SC_HOME_DIR_NAME"
                value="schome"/-->
            <sysproperty key="smack.debugEnabled" value="${smack.debugEnabled}"/>
            <!--sysproperty key="smack.debuggerClass"
                value="org.jivesoftware.smack.debugger.ConsoleDebugger"/-->
            <!-- Setting properties necessary for dependencies on native libs.-->
            <sysproperty key="java.library.path" path="${ld.library.path}:${path}:${dyld.library.path}"/>
            <sysproperty key="jna.library.path" path="${ld.library.path}:${path}:${dyld.library.path}"/>
            <env key="LD_LIBRARY_PATH" path="${ld.library.path}"/>
            <env key="PATH" path="${path}"/>
            <env key="DYLD_LIBRARY_PATH" path="${dyld.library.path}"/>
            <!-- pass l10n properties from ant call for
                 easy translation debugging -->
            <sysproperty key="user.language" value="${user.language}"/>
            <sysproperty key="user.country" value="${user.country}"/>
            <sysproperty key="user.variant" value="${user.variant}"/>
            <!-- make sure that we automatically enable system.out when running
                 Jitsi from Ant-->
            <arg line="--debug"/>
            <!-- pass to SC args that have been specified by the user -->
            <arg line="${args}"/>
            <sysproperty key="org.osgi.framework.bootdelegation" value="${profiler.bootdelegation}"/>
            <sysproperty key="felix.auto.start.68" value="${profiler.autostart}"/>
            <!-- add some eventual profiler args, prevent server-class
                 detection because -server uses much more memory for 32-bit OS
                 (64-bit always used -server) -->
            <jvmarg line="${profiler.args} ${jvmarg.line}               -client ${jvm.maxheapsize} ${jvmarg.splash} ${jvmarg.aegeturl}"/>
            <sysproperty key="apple.laf.useScreenMenuBar" value="true"/>
            <jvmarg value="-Xdebug"/>
            <jvmarg value="-Xrunjdwp:transport=dt_socket,address=${jpda.address}"/>
        </java>
    </target>
</project>
